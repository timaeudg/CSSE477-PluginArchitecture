package gui;

import java.awt.Component;
import java.awt.EventQueue;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JTextPane;
import javax.swing.ListSelectionModel;
import javax.swing.border.BevelBorder;
import javax.swing.border.EmptyBorder;
import javax.swing.JTextArea;
import javax.swing.JScrollBar;

import main.PluginLoader;

public class FrameworkWindow extends JFrame implements FrameworkGUI,
		ActionListener {
	PluginLoader pluginLoader;

	private static final long serialVersionUID = -594503413910961630L;
	private JPanel contentPane;

	private JPanel ExecutionPanel;
	private JList<String> PluginList;
	private JTextArea StatusArea;

	/**
	 * Launch the application.
	 */
	public static void main(String[] args) {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					PluginLoader p = null;
					
					FrameworkWindow frame = new FrameworkWindow(p);
					frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}

	/**
	 * Create the frame.
	 */
	public FrameworkWindow(PluginLoader pluginLoader) {
		this.pluginLoader = pluginLoader;
		setTitle("Doge Plugin Framework");
		setIconImage(Toolkit
				.getDefaultToolkit()
				.getImage(
						"C:\\workspaces\\CSSE477\\CSSE477-PluginArchitecture\\PluginFramework\\pixel_doge.png"));
		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		setBounds(100, 100, 800, 600);
		contentPane = new JPanel();
		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
		setContentPane(contentPane);
		contentPane.setLayout(null);

		ExecutionPanel = new JPanel();
		ExecutionPanel.setBounds(200, 5, 579, 395);
		contentPane.add(ExecutionPanel);
		ExecutionPanel.setLayout(null);

		JPanel StatusPanel = new JPanel();
		StatusPanel.setBounds(5, 411, 774, 139);
		StatusPanel.setAlignmentY(Component.BOTTOM_ALIGNMENT);
		contentPane.add(StatusPanel);
		StatusPanel.setLayout(null);

		StatusArea = new JTextArea();
		StatusArea.setLineWrap(true);
		StatusArea.setEditable(false);
		StatusArea.setBounds(0, 0, 774, 139);
		StatusPanel.add(StatusArea);

		JPanel DirectoryPanel = new JPanel();
		DirectoryPanel.setBounds(5, 5, 185, 20);
		contentPane.add(DirectoryPanel);
		DirectoryPanel.setLayout(null);
		
		JButton DirButton = new JButton("Set New Directory");
		DirButton.setBounds(0, 0, 180, 20);
		DirectoryPanel.add(DirButton);
		DirButton.addActionListener(this);
		
		JPanel PluginPanel = new JPanel();
		PluginPanel.setBounds(5, 25, 185, 375);
		contentPane.add(PluginPanel);
		PluginPanel.setLayout(null);

		JButton LoadButton = new JButton("Load Plugin");
		LoadButton.setBounds(0, 352, 185, 23);
		PluginPanel.add(LoadButton);
		LoadButton.addActionListener(this);

		PluginList = new JList<String>();
		PluginList.setBorder(new BevelBorder(BevelBorder.LOWERED, null, null,
				null, null));
		PluginList.setVisibleRowCount(20);
		PluginList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
		PluginList.setBounds(0, 0, 185, 361);
		PluginPanel.add(PluginList);
	}

	@Override
	public void print(String s) {
		this.StatusArea.setText(this.StatusArea.getText() + s);
	}

	@Override
	public void println(String s) {
		this.StatusArea.setText(this.StatusArea.getText() + s + "\n");
	}

	@Override
	public void clearStatus() {
		this.StatusArea.setText("");
	}

	@Override
	public void populatePluginList(String[] pluginList) {
		this.PluginList.setListData(pluginList);
	}

	@Override
	public JPanel getExecutionPanel() {
		return this.ExecutionPanel;
	}

	// @Override
	public JPanel resetExecutionPanel() {
		return null;
	}

	@Override
	public void actionPerformed(ActionEvent e) {
		//this.framework.loadPlugin(currentlySelectedPlugin);
	}
	
	public String switchDir() {
		JFileChooser chooser = new JFileChooser();
		chooser.setCurrentDirectory(new java.io.File("./DropJarsHere/"));
		chooser.setDialogTitle("Choose a directory to load jars from.");
		chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
		chooser.setAcceptAllFileFilterUsed(false);
		if(chooser.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
			pluginLoader.setDir(chooser.getCurrentDirectory().toString());
			
		}
		
		
		return null;
	}
}
