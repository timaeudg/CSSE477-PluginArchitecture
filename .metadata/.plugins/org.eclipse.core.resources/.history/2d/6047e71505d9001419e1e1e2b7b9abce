package main;

import java.io.File;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.ArrayList;
import java.util.Enumeration;
import java.util.List;
import java.util.jar.JarEntry;
import java.util.jar.JarFile;

import framework.IPlugin;
import framework.Plugin;

public class PluginLoader {

	List<Plugin> loadPlugins;
	
	public PluginLoader(List<Plugin> plugins){
		
		loadPlugins = plugins;
		
	};
	
	public PluginLoader(){
		
		loadPlugins = new ArrayList<>();
		loadJar("examplePlugin.jar");
		
	};
	
	public void loadJar(String filePath) {
		
		JarFile jarFile = new JarFile(filePath);
	    Enumeration<JarEntry> e = jarFile.entries();

	    URL[] urls = { new URL("jar:file:" + filePath+"!/") };
	    URLClassLoader cl = URLClassLoader.newInstance(urls);

	        while (e.hasMoreElements()) {
	            JarEntry je = (JarEntry) e.nextElement();
	            if(je.isDirectory() || !je.getName().endsWith(".class")){
	                continue;
	            }
	            String className = je.getName().substring(0,je.getName().length()-6);
	            className = className.replace('/', '.');
	            Class c = cl.loadClass(className);
	            System.out.println(IPlugin.class.isAssignableFrom(c));

	    }   
		
		
	}
	
}
